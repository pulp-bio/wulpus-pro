Version 4
SHEET 1 1912 1528
WIRE -80 96 -160 96
WIRE 160 96 -16 96
WIRE 560 160 320 160
WIRE 688 160 624 160
WIRE 720 160 688 160
WIRE -64 192 -144 192
WIRE 160 192 0 192
WIRE 416 224 320 224
WIRE 544 224 416 224
WIRE 160 256 80 256
WIRE 400 256 320 256
WIRE 544 352 544 224
WIRE 1280 352 1056 352
WIRE 1424 352 1360 352
WIRE -224 384 -272 384
WIRE -272 432 -272 384
WIRE 1056 432 1056 352
WIRE 1120 432 1056 432
WIRE 1280 432 1184 432
WIRE 1280 544 1280 432
WIRE 1328 544 1280 544
WIRE 1424 544 1424 352
WIRE 1424 544 1392 544
WIRE 1488 544 1424 544
WIRE 1520 544 1488 544
WIRE 1024 560 1024 384
WIRE 1088 560 1024 560
WIRE 1280 560 1280 544
WIRE 1280 560 1248 560
WIRE 944 592 848 592
WIRE 1056 592 1056 432
WIRE 1056 592 1024 592
WIRE 1088 592 1056 592
WIRE 1296 592 1248 592
WIRE 1088 624 1056 624
WIRE 1280 624 1248 624
WIRE -32 688 -288 688
WIRE 112 688 48 688
WIRE 256 688 112 688
WIRE 1056 688 1056 624
WIRE 1280 688 1280 624
WIRE 1280 688 1232 688
WIRE -288 720 -288 688
WIRE 1232 720 1232 688
WIRE 1232 720 1152 720
WIRE 1296 720 1296 592
WIRE 112 736 112 688
WIRE 1024 1056 880 1056
WIRE 1168 1056 1104 1056
WIRE 1376 1056 1168 1056
FLAG 544 432 0
FLAG 688 160 vga_out
FLAG -160 96 vga_in
FLAG -144 192 vga_vref
FLAG 416 224 vga_mcu
FLAG 400 256 vga_vref
FLAG 80 256 vga_gain
FLAG -272 512 0
FLAG -224 384 vga_in
FLAG -288 800 0
FLAG 112 800 0
FLAG 256 688 vga_gain
FLAG 1488 544 vout_rect
FLAG 1024 384 0
FLAG 848 592 vga_out
FLAG 1152 800 0
FLAG 1296 800 0
FLAG 880 1056 vout_rect
FLAG 1168 1120 0
FLAG 1376 1056 vout_env
FLAG 1056 688 0
SYMBOL cap 624 144 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C1
SYMATTR Value 1n
SYMBOL voltage 544 336 R0
SYMATTR InstName V1
SYMBOL cap 0 176 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C2
SYMATTR Value 1n
SYMBOL cap -16 80 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C3
SYMATTR Value 1n
SYMBOL voltage -272 416 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value SINE(0 10mV 10000000 40us 0 0 3)
SYMBOL voltage -288 704 R0
WINDOW 3 -279 157 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR Value PWL(0 0 5us 0 5.1us 3.3 100us 3.3 101us 0)
SYMATTR InstName V3
SYMBOL cap 96 736 R0
SYMATTR InstName C4
SYMATTR Value 50n
SYMBOL res 64 672 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 4000
SYMBOL AD8338 240 176 R0
SYMATTR InstName U1
SYMBOL res 1040 576 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value 150
SYMBOL schottky 1120 448 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D1
SYMATTR Value BAT54SHY
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL schottky 1328 560 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D2
SYMATTR Value BAT54SHY
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL res 1376 336 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMATTR Value 150
SYMBOL voltage 1296 704 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V4
SYMATTR Value 3
SYMBOL voltage 1152 704 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V5
SYMATTR Value -3
SYMBOL OPA837 1152 592 R0
SYMATTR InstName U3
SYMBOL res 1120 1040 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R
SYMATTR Value 4000
SYMBOL cap 1152 1056 R0
SYMATTR InstName C5
SYMATTR Value 100pf
TEXT 120 -136 Left 2 !.tran 0 0.001 0 5us
